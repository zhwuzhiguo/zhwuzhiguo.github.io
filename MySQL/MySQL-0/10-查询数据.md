# 基本查询语句

    select 属性列表
    from 表名和视图列表
    [where 条件表达式1]
    [group by 属性名1 [having 条件表达式2]]
    [order by 属性名2 [asc|desc]]

    // 示例
    mysql> select * from employee;
    +----+---------+-----+---------+---------------------+
    | id | dept_id | num | name    | create_time         |
    +----+---------+-----+---------+---------------------+
    |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
    |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
    |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
    |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
    |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
    +----+---------+-----+---------+---------------------+
    5 rows in set (0.00 sec)

    // having 后可用聚合函数列的别名
    mysql> select dept_id, count(*) as emp_count from employee
        -> where id > 1
        -> group by dept_id having emp_count > 1
        -> order by dept_id asc;
    +---------+-----------+
    | dept_id | emp_count |
    +---------+-----------+
    |      24 |         3 |
    +---------+-----------+
    1 row in set (0.00 sec)

    // order by 后可以按不同字段，不同顺序排序
    mysql> select * from employee
        -> order by dept_id desc, name asc;
    +----+---------+-----+---------+---------------------+
    | id | dept_id | num | name    | create_time         |
    +----+---------+-----+---------+---------------------+
    |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
    |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
    |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
    |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
    |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
    +----+---------+-----+---------+---------------------+
    5 rows in set (0.00 sec)

# 单表查询

* 条件运算符

        // !=和<>一样
        mysql> select * from employee where id != 3;
        mysql> select * from employee where id <> 3;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        4 rows in set (0.00 sec)

* between and

        // between and 是闭区间
        mysql> select * from employee where id between 3 and 5;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        3 rows in set (0.00 sec)

        mysql> select * from employee where id not between 3 and 5;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+

        // between and 也可用于字符串字段
        mysql> select * from employee where name between '张三1' and '张三4';
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+

* in

        mysql> select * from employee where id in (1,4,6);
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        3 rows in set (0.00 sec)

        mysql> select * from employee where id not in (1,4,6);
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

* like

        // like 后字符串单引号和双引号都可以
        mysql> select * from employee where name like '%张三%';
        mysql> select * from employee where name like "%张三%";
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        5 rows in set (0.00 sec)

        mysql> select * from employee where name not like '%张三%';
        Empty set (0.00 sec)

        // _代表一个字符
        mysql> select * from employee where name like '张_';
        +----+---------+-----+--------+---------------------+
        | id | dept_id | num | name   | create_time         |
        +----+---------+-----+--------+---------------------+
        |  6 |      24 | 005 | 张三   | 2017-11-22 15:03:31 |
        +----+---------+-----+--------+---------------------+
        1 row in set (0.00 sec)

* null

        mysql> select * from employee where name is null;
        +----+---------+-----+------+---------------------+
        | id | dept_id | num | name | create_time         |
        +----+---------+-----+------+---------------------+
        |  7 |      24 | 006 | NULL | 2017-11-22 15:03:31 |
        +----+---------+-----+------+---------------------+
        1 row in set (0.00 sec)

        mysql> select * from employee where name is not null;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三5   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        5 rows in set (0.00 sec)

* distinct

        mysql> select dept_id from employee;
        +---------+
        | dept_id |
        +---------+
        |      22 |
        |      22 |
        |      24 |
        |      24 |
        |      24 |
        |      24 |
        +---------+
        6 rows in set (0.00 sec)

        // distinct 过滤重复记录
        mysql> select distinct dept_id from employee;
        +---------+
        | dept_id |
        +---------+
        |      22 |
        |      24 |
        +---------+
        2 rows in set (0.00 sec)

* group by 

        // group by 示例
        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        // group by 如果不使用聚合函数，查询结果就是字段取值的分组情况。
        // 字段中取值相同的记录为一组，但只显示该组的第一条记录
        mysql> select * from employee group by dept_id;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

        // group by 和 group_concat 一起使用, 显示每个分组中的字段值列表。
        mysql> select dept_id, count(*) as emp_count, group_concat(id), group_concat(num), group_concat(name) from employee group by dept_id having emp_count > 2;
        +---------+-----------+------------------+-------------------+------------------------+
        | dept_id | emp_count | group_concat(id) | group_concat(num) | group_concat(name)     |
        +---------+-----------+------------------+-------------------+------------------------+
        |      24 |         4 | 4,5,6,7          | 003,004,005,006   | 张三3,张三4,张三       |
        +---------+-----------+------------------+-------------------+------------------------+

        // group by 按多字段分组。
        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        mysql> select dept_id, name, count(*) as emp_count from employee group by dept_id, name having emp_count > 0;
        +---------+---------+-----------+
        | dept_id | name    | emp_count |
        +---------+---------+-----------+
        |      22 | 张三    |         1 |
        |      22 | 张三1   |         1 |
        |      24 | NULL    |         1 |
        |      24 | 张三    |         1 |
        |      24 | 张三1   |         2 |
        +---------+---------+-----------+
        5 rows in set (0.00 sec)

        // group by 后面加 with rollup, 查询结果多出一行统计行，会统计非分组字段。
        mysql> select dept_id, group_concat(name), count(*) as emp_count from employee group by dept_id;
        +---------+------------------------+-----------+
        | dept_id | group_concat(name)     | emp_count |
        +---------+------------------------+-----------+
        |      22 | 张三1,张三              |         2 |
        |      24 | 张三1,张三1,张三         |         4 |
        +---------+------------------------+-----------+
        2 rows in set (0.00 sec)

        mysql> select dept_id, group_concat(name), count(*) as emp_count from employee group by dept_id with rollup;
        +---------+---------------------------------------+-----------+
        | dept_id | group_concat(name)                    | emp_count |
        +---------+---------------------------------------+-----------+
        |      22 | 张三1,张三                             |         2 |
        |      24 | 张三1,张三1,张三                        |         4 |
        |    NULL | 张三1,张三,张三1,张三1,张三              |         6 |
        +---------+---------------------------------------+-----------+
        3 rows in set (0.00 sec)

        mysql> select dept_id, group_concat(name), count(*) as emp_count from employee group by dept_id with rollup having emp_count > 2;
        +---------+---------------------------------------+-----------+
        | dept_id | group_concat(name)                    | emp_count |
        +---------+---------------------------------------+-----------+
        |      24 | 张三1,张三1,张三                        |         4 |
        |    NULL | 张三1,张三,张三1,张三1,张三              |         6 |
        +---------+---------------------------------------+-----------+

* limit

        // limit 记录数
        // limit 初始位置, 记录数
        // 初始位置默认是0
        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        mysql> select * from employee limit 3;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        3 rows in set (0.00 sec)

        mysql> select * from employee limit 0, 3;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        3 rows in set (0.00 sec)

        mysql> select * from employee limit 2, 3;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        3 rows in set (0.00 sec)

# 集合函数查询

    mysql> select * from employee;
    +----+---------+-----+---------+---------------------+
    | id | dept_id | num | name    | create_time         |
    +----+---------+-----+---------+---------------------+
    |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
    |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
    |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
    |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
    |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
    |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
    +----+---------+-----+---------+---------------------+
    6 rows in set (0.00 sec)

    mysql> select dept_id, count(id) from employee where dept_id = 22;
    +---------+-----------+
    | dept_id | count(id) |
    +---------+-----------+
    |      22 |         2 |
    +---------+-----------+
    1 row in set (0.00 sec)

    mysql> select dept_id, sum(id) from employee where dept_id = 22;
    +---------+---------+
    | dept_id | sum(id) |
    +---------+---------+
    |      22 |       4 |
    +---------+---------+
    1 row in set (0.00 sec)

    mysql> select dept_id, avg(id) from employee where dept_id = 22;
    +---------+---------+
    | dept_id | avg(id) |
    +---------+---------+
    |      22 |  2.0000 |
    +---------+---------+
    1 row in set (0.00 sec)

    mysql> select dept_id, max(id) from employee where dept_id = 22;
    +---------+---------+
    | dept_id | max(id) |
    +---------+---------+
    |      22 |       3 |
    +---------+---------+
    1 row in set (0.00 sec)

    mysql> select dept_id, min(id) from employee where dept_id = 22;
    +---------+---------+
    | dept_id | min(id) |
    +---------+---------+
    |      22 |       1 |
    +---------+---------+
    1 row in set (0.00 sec)

    // max和min参数使用字符串，按字符串的编码比较
    // a最小，z最大
    mysql> select dept_id, max(name) from employee where dept_id = 22;
    +---------+-----------+
    | dept_id | max(name) |
    +---------+-----------+
    |      22 | 张三1     |
    +---------+-----------+
    1 row in set (0.00 sec)

    mysql> select dept_id, min(name) from employee where dept_id = 22;
    +---------+-----------+
    | dept_id | min(name) |
    +---------+-----------+
    |      22 | 张三      |
    +---------+-----------+
    1 row in set (0.00 sec)

# 连接查询

* 内连接查询

    只能查询出连接字段相同的记录，其中某一个表中连接字段值在其他表中不存在的记录不会查询出来。

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
        |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        mysql> select * from department, employee where department.id = employee.dept_id;
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        | id | num | name      | create_time         | id | dept_id | num | name    | create_time         |
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |  3 |      22 | 002 | 张三    | 2017-11-22 15:03:31 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |  4 |      24 | 003 | 张三1   | 2017-11-22 15:03:31 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |  5 |      24 | 004 | 张三1   | 2017-11-22 15:03:31 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |  6 |      24 | 005 | 张三    | 2017-11-22 15:03:31 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |  7 |      24 | 006 | NULL    | 2017-11-22 15:03:31 |
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

* 外连接查询

        // 语法
        select 属性名列表 from 表1
        left|right join 表2 on 表1.属性名1 = 表2.属性名2;

        left  左连接，可以查询出表1的所有记录 和 表2的匹配记录。
        right 右连接，可以查询出表2的所有记录 和 表1的匹配记录。

        // 示例
        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        // 左连接
        mysql> select * from employee
            -> left join department on employee.dept_id = department.id;
        +----+---------+-----+---------+---------------------+------+------+-----------+---------------------+
        | id | dept_id | num | name    | create_time         | id   | num  | name      | create_time         |
        +----+---------+-----+---------+---------------------+------+------+-----------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |   22 | 110  | 财务部    | 2017-11-22 10:47:09 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |   22 | 110  | 财务部    | 2017-11-22 10:47:09 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |   24 | 111  | 技术部    | 2017-11-22 11:19:50 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |   24 | 111  | 技术部    | 2017-11-22 11:19:50 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 | NULL | NULL | NULL      | NULL                |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 | NULL | NULL | NULL      | NULL                |
        +----+---------+-----+---------+---------------------+------+------+-----------+---------------------+
        6 rows in set (0.00 sec)

        // 右连接
        mysql> select * from employee
            -> right join department on employee.dept_id = department.id;
        +------+---------+------+---------+---------------------+----+-----+-----------+---------------------+
        | id   | dept_id | num  | name    | create_time         | id | num | name      | create_time         |
        +------+---------+------+---------+---------------------+----+-----+-----------+---------------------+
        |    1 |      22 | 001  | 张三1   | 2017-11-22 15:03:31 | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        |    3 |      22 | 002  | 张三2   | 2017-11-22 15:03:31 | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        |    4 |      24 | 003  | 张三3   | 2017-11-22 15:03:31 | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        |    5 |      24 | 004  | 张三4   | 2017-11-22 15:03:31 | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | NULL |    NULL | NULL | NULL    | NULL                | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | NULL |    NULL | NULL | NULL    | NULL                | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +------+---------+------+---------+---------------------+----+-----+-----------+---------------------+
        6 rows in set (0.00 sec)

* 复合条件连接查询

        mysql> select * from department, employee  
        where department.id = employee.dept_id 
        and department.num = '111' 
        and employee.num = '004';
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        | id | num | name      | create_time         | id | dept_id | num | name    | create_time         |
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+-----+-----------+---------------------+----+---------+-----+---------+---------------------+
        1 row in set (0.00 sec)
   
# 子查询

* in

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        mysql> select * from employee where dept_id in (select id from department where id > 22);
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

        mysql> select * from employee where dept_id not in (select id from department where id > 22);
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        4 rows in set (0.00 sec)

* 比较运算符

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        mysql> select * from employee where dept_id >= (select id from department where name = '技术部');
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        4 rows in set (0.00 sec)

        // 子查询返回的值需要唯一
        mysql> select * from employee where dept_id >= (select id from department where name like '%部%');
        ERROR 1242 (21000): Subquery returns more than 1 row

* exists

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        // exists 子查询返回true或false
        mysql> select * from employee where exists (select * from department where name = '技术部') and dept_id = 24;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

        mysql> select * from employee where not exists (select * from department where name = '技术部');
        Empty set (0.00 sec)

* any

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        // dept_id 等于子查询集合中的任意一项
        mysql> select * from employee where dept_id = any (select id from department where name = '技术部' or name = '财务部');
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee where dept_id = any (select id from department where name = '技术部');
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

* all

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee;
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
        |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        6 rows in set (0.00 sec)

        // dept_id 大于等于子查询集合中的所有项
        mysql> select * from employee where dept_id >= all (select id from department where name = '技术部' or name = '财务部');
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
        |  5 |      24 | 004 | 张三4   | 2017-11-22 15:03:31 |
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from employee where dept_id >= all (select id from department);
        +----+---------+-----+---------+---------------------+
        | id | dept_id | num | name    | create_time         |
        +----+---------+-----+---------+---------------------+
        |  6 |      99 | 005 | 张三5   | 2017-11-22 15:03:31 |
        |  7 |      99 | 006 | 张三6   | 2017-11-22 15:03:31 |
        +----+---------+-----+---------+---------------------+
        2 rows in set (0.00 sec)

# 合并查询结果

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        mysql> select * from department where id <= 26;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        3 rows in set (0.00 sec)

        mysql> select * from department where id >= 24;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        3 rows in set (0.00 sec)

        // union 合并会去掉重复记录
        mysql> select * from department where id <= 26 union select * from department where id >= 24;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.01 sec)

        // union all 合并不去重
        mysql> select * from department where id <= 26 union all select * from department where id >= 24;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        6 rows in set (0.00 sec)

# 为表和字段取别名

    // 使用as定义别名
    mysql> select id as dept_id, name as dept_name from department as dept where dept.id >= 24;
    +---------+-----------+
    | dept_id | dept_name |
    +---------+-----------+
    |      24 | 技术部    |
    |      26 | 交通部    |
    |      27 | 教育部    |
    +---------+-----------+
    3 rows in set (0.00 sec)

    // 直接空格定义别名
    mysql> select id dept_id, name dept_name from department dept where dept.id >= 24;
    +---------+-----------+
    | dept_id | dept_name |
    +---------+-----------+
    |      24 | 技术部    |
    |      26 | 交通部    |
    |      27 | 教育部    |
    +---------+-----------+
    3 rows in set (0.00 sec)

    mysql> select id dept_id, name dept_name from department dept where id >= 24;
    +---------+-----------+
    | dept_id | dept_name |
    +---------+-----------+
    |      24 | 技术部    |
    |      26 | 交通部    |
    |      27 | 教育部    |
    +---------+-----------+
    3 rows in set (0.00 sec)

    // where 条件中不能使用别名
    // 如果想使用，可作为子表查询
    mysql> select id dept_id, name dept_name from department dept where dept_id >= 24;
    ERROR 1054 (42S22): Unknown column 'dept_id' in 'where clause'

# 使用正则表达式查询

    // 匹配指定字符中的任意一个
    mysql> select * from employee where name regexp '[123]';
    +----+---------+-----+---------+---------------------+
    | id | dept_id | num | name    | create_time         |
    +----+---------+-----+---------+---------------------+
    |  1 |      22 | 001 | 张三1   | 2017-11-22 15:03:31 |
    |  3 |      22 | 002 | 张三2   | 2017-11-22 15:03:31 |
    |  4 |      24 | 003 | 张三3   | 2017-11-22 15:03:31 |
    +----+---------+-----+---------+---------------------+
    3 rows in set (0.00 sec)


# 完。
