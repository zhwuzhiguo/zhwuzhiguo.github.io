# 数学函数

1. 绝对值函数和圆周率函数

        mysql> select abs(5), abs(-5), abs(5.5), abs(-5.5), pi();
        +--------+---------+----------+-----------+----------+
        | abs(5) | abs(-5) | abs(5.5) | abs(-5.5) | pi()     |
        +--------+---------+----------+-----------+----------+
        |      5 |       5 |      5.5 |       5.5 | 3.141593 |
        +--------+---------+----------+-----------+----------+
        1 row in set (0.00 sec)

2. 平方根函数和求余函数

        mysql> select sqrt(16), sqrt(2), sqrt(-2), mod(5,2);
        +----------+--------------------+----------+----------+
        | sqrt(16) | sqrt(2)            | sqrt(-2) | mod(5,2) |
        +----------+--------------------+----------+----------+
        |        4 | 1.4142135623730951 |     NULL |        1 |
        +----------+--------------------+----------+----------+
        1 row in set (0.00 sec)

3. 获取整数的函数

        // ceil(x)和ceiling(x)一样, 返回大于等于x的最小整数
        // floor(x)返回小于等于x的最大整数
        mysql> select ceil(2.3), ceiling(2.3), ceil(-2.3), ceiling(-2.3), floor(2.3), floor(-2.3);
        +-----------+--------------+------------+---------------+------------+-------------+
        | ceil(2.3) | ceiling(2.3) | ceil(-2.3) | ceiling(-2.3) | floor(2.3) | floor(-2.3) |
        +-----------+--------------+------------+---------------+------------+-------------+
        |         3 |            3 |         -2 |            -2 |          2 |          -3 |
        +-----------+--------------+------------+---------------+------------+-------------+
        1 row in set (0.00 sec)

4. 获取随机数的函数

        // rand()返回0-1的随机数，每次都不同
        // rand(x)返回0-1的随机数，但相同的x返回相同随机数
        mysql> select rand(), rand(), rand(2), rand(3);
        +--------------------+--------------------+--------------------+--------------------+
        | rand()             | rand()             | rand(2)            | rand(3)            |
        +--------------------+--------------------+--------------------+--------------------+
        | 0.4298861617500765 | 0.6706728242995895 | 0.6555866465490187 | 0.9057697559760601 |
        +--------------------+--------------------+--------------------+--------------------+
        1 row in set (0.00 sec)

        mysql> select rand(), rand(), rand(2), rand(3);
        +---------------------+--------------------+--------------------+--------------------+
        | rand()              | rand()             | rand(2)            | rand(3)            |
        +---------------------+--------------------+--------------------+--------------------+
        | 0.06370566698136336 | 0.3065098927416931 | 0.6555866465490187 | 0.9057697559760601 |
        +---------------------+--------------------+--------------------+--------------------+
        1 row in set (0.00 sec)

5. 四舍五入函数

        // round(x) 四舍五入取整数
        // round(x, y) 四舍五入保留y位小数
        // truncate(x, y) 截断保留y位小数
        mysql> select round(2.3), round(2.5), round(2.53, 1), round(2.55, 1), truncate(2.53, 1), truncate(2.55, 1);
        +------------+------------+----------------+----------------+-------------------+-------------------+
        | round(2.3) | round(2.5) | round(2.53, 1) | round(2.55, 1) | truncate(2.53, 1) | truncate(2.55, 1) |
        +------------+------------+----------------+----------------+-------------------+-------------------+
        |          2 |          3 |            2.5 |            2.6 |               2.5 |               2.5 |
        +------------+------------+----------------+----------------+-------------------+-------------------+
        1 row in set (0.00 sec)

6. 符号函数

        // sign 判断正数，负数，零
        mysql> select sign(-2), sign(0), sign(2);
        +----------+---------+---------+
        | sign(-2) | sign(0) | sign(2) |
        +----------+---------+---------+
        |       -1 |       0 |       1 |
        +----------+---------+---------+
        1 row in set (0.00 sec)

        mysql> select sign(-2.5), sign(0.0), sign(2.5);
        +------------+-----------+-----------+
        | sign(-2.5) | sign(0.0) | sign(2.5) |
        +------------+-----------+-----------+
        |         -1 |         0 |         1 |
        +------------+-----------+-----------+
        1 row in set (0.00 sec)

        mysql> select sign(-2.5), sign(0.1), sign(2.5);
        +------------+-----------+-----------+
        | sign(-2.5) | sign(0.1) | sign(2.5) |
        +------------+-----------+-----------+
        |         -1 |         1 |         1 |
        +------------+-----------+-----------+
        1 row in set (0.00 sec)

7. 幂运算函数 

        // pow(x, y) 和 power(x, y) 一样，计算x的y次方
        // exp(x) e的x次方
        mysql> select pow(2, 3), power(2, 3), exp(2);
        +-----------+-------------+------------------+
        | pow(2, 3) | power(2, 3) | exp(2)           |
        +-----------+-------------+------------------+
        |         8 |           8 | 7.38905609893065 |
        +-----------+-------------+------------------+

8. 对数函数

        // log是自然对数函数，exp的反函数
        // log10是10的对数函数
        mysql> select log(7.38905609893065), log10(100);
        +-----------------------+------------+
        | log(7.38905609893065) | log10(100) |
        +-----------------------+------------+
        |                     2 |          2 |
        +-----------------------+------------+

9. 角度和弧度互转函数

        // 角度转弧度
        mysql> select radians(180);
        +-------------------+
        | radians(180)      |
        +-------------------+
        | 3.141592653589793 |
        +-------------------+
        1 row in set (0.00 sec)

        // 弧度转角度
        mysql> select degrees(3.141592653589793);
        +----------------------------+
        | degrees(3.141592653589793) |
        +----------------------------+
        |                        180 |
        +----------------------------+
        1 row in set (0.00 sec)

10. 正弦函数和反正弦函数

        mysql> select sin(3.1415926/2);
        +--------------------+
        | sin(3.1415926/2)   |
        +--------------------+
        | 0.9999999999999997 |
        +--------------------+
        1 row in set (0.00 sec)

        mysql> select asin(1);
        +--------------------+
        | asin(1)            |
        +--------------------+
        | 1.5707963267948966 |
        +--------------------+
        1 row in set (0.00 sec)

11. 余弦函数和反余弦函数

        mysql> select cos(0);
        +--------+
        | cos(0) |
        +--------+
        |      1 |
        +--------+
        1 row in set (0.00 sec)

        mysql> select acos(1);
        +---------+
        | acos(1) |
        +---------+
        |       0 |
        +---------+
        1 row in set (0.00 sec)

12. 正切函数、反正切函数和余切函数

        mysql> select tan(3.14/4);
        +--------------------+
        | tan(3.14/4)        |
        +--------------------+
        | 0.9992039901050427 |
        +--------------------+
        1 row in set (0.00 sec)

        mysql> select atan(1);
        +--------------------+
        | atan(1)            |
        +--------------------+
        | 0.7853981633974483 |
        +--------------------+
        1 row in set (0.00 sec)

        mysql> select cot(3.14/4);
        +-------------------+
        | cot(3.14/4)       |
        +-------------------+
        | 1.000796644031489 |
        +-------------------+
        1 row in set (0.00 sec)

# 字符串函数

1. 计算字符串字符数函数和字符串长度函数

        mysql> select char_length('beijing'), length('beijing');
        +------------------------+-------------------+
        | char_length('beijing') | length('beijing') |
        +------------------------+-------------------+
        |                      7 |                 7 |
        +------------------------+-------------------+
        1 row in set (0.00 sec)

        mysql> select * from department;
        +----+-----+-----------+---------------------+
        | id | num | name      | create_time         |
        +----+-----+-----------+---------------------+
        | 22 | 110 | 财务部    | 2017-11-22 10:47:09 |
        | 24 | 111 | 技术部    | 2017-11-22 11:19:50 |
        | 26 | 112 | 交通部    | 2017-11-22 11:19:50 |
        | 27 | 113 | 教育部    | 2017-11-22 11:19:50 |
        +----+-----+-----------+---------------------+
        4 rows in set (0.00 sec)

        // char_length计算字符数
        // length计算占用字节数
        mysql> select char_length(num), length(num), char_length(name), length(name) from department;
        +------------------+-------------+-------------------+--------------+
        | char_length(num) | length(num) | char_length(name) | length(name) |
        +------------------+-------------+-------------------+--------------+
        |                3 |           3 |                 3 |            9 |
        |                3 |           3 |                 3 |            9 |
        |                3 |           3 |                 3 |            9 |
        |                3 |           3 |                 3 |            9 |
        +------------------+-------------+-------------------+--------------+
        4 rows in set (0.00 sec)

2. 合并字符串的函数

        // concat() 将多个字符串连接起来
        // concat_ws() 将多个字符串用分隔串连接起来
        mysql> select concat('bei', 'ji', 'ng'), concat_ws('--', 'bei', 'ji', 'ng');
        +---------------------------+------------------------------------+
        | concat('bei', 'ji', 'ng') | concat_ws('--', 'bei', 'ji', 'ng') |
        +---------------------------+------------------------------------+
        | beijing                   | bei--ji--ng                        |
        +---------------------------+------------------------------------+
        1 row in set (0.00 sec)

3. 替换字符串的函数

        // 替换给定字符串指定位置(索引从1开始)开始的指定长度内容为新字符串
        mysql> select insert('1234567890', 3, 3, 'aaaaa');
        +-------------------------------------+
        | insert('1234567890', 3, 3, 'aaaaa') |
        +-------------------------------------+
        | 12aaaaa67890                        |
        +-------------------------------------+
        1 row in set (0.00 sec)

4. 大小写转换函数

        // upper和ucase作用相同
        // lower和lcase作用相同
        mysql> select upper('MySql'), ucase('MySql'), lower('MySql'), lcase('MySql');
        +----------------+----------------+----------------+----------------+
        | upper('MySql') | ucase('MySql') | lower('MySql') | lcase('MySql') |
        +----------------+----------------+----------------+----------------+
        | MYSQL          | MYSQL          | mysql          | mysql          |
        +----------------+----------------+----------------+----------------+
        1 row in set (0.00 sec)

5. 获取指定长度字符串函数

        // 获取左边或右边指定长度的字符串
        mysql> select left('1234567890', 3), right('1234567890', 3);
        +-----------------------+------------------------+
        | left('1234567890', 3) | right('1234567890', 3) |
        +-----------------------+------------------------+
        | 123                   | 890                    |
        +-----------------------+------------------------+
        1 row in set (0.00 sec)

        mysql> select left('1234567890', 0), right('1234567890', 0);
        +-----------------------+------------------------+
        | left('1234567890', 0) | right('1234567890', 0) |
        +-----------------------+------------------------+
        |                       |                        |
        +-----------------------+------------------------+
        1 row in set (0.00 sec)

        mysql> select left('1234567890', -1), right('1234567890', -1);
        +------------------------+-------------------------+
        | left('1234567890', -1) | right('1234567890', -1) |
        +------------------------+-------------------------+
        |                        |                         |
        +------------------------+-------------------------+
        1 row in set (0.00 sec)

        mysql> select left('1234567890', 20), right('1234567890', 20);
        +------------------------+-------------------------+
        | left('1234567890', 20) | right('1234567890', 20) |
        +------------------------+-------------------------+
        | 1234567890             | 1234567890              |
        +------------------------+-------------------------+
        1 row in set (0.00 sec)

6. 填充字符串函数

        // 左或右填充指定字符串达到指定长度
        mysql> select lpad('1234567890', 20, 'abcd'), rpad('1234567890', 20, 'abcd');
        +--------------------------------+--------------------------------+
        | lpad('1234567890', 20, 'abcd') | rpad('1234567890', 20, 'abcd') |
        +--------------------------------+--------------------------------+
        | abcdabcdab1234567890           | 1234567890abcdabcdab           |
        +--------------------------------+--------------------------------+
        1 row in set (0.00 sec)

7. 删除空格的函数

        mysql> select concat('+', ltrim(' aaa '), '+');
        +----------------------------------+
        | concat('+', ltrim(' aaa '), '+') |
        +----------------------------------+
        | +aaa +                           |
        +----------------------------------+
        1 row in set (0.00 sec)

        mysql> select concat('+', rtrim(' aaa '), '+');
        +----------------------------------+
        | concat('+', rtrim(' aaa '), '+') |
        +----------------------------------+
        | + aaa+                           |
        +----------------------------------+
        1 row in set (0.00 sec)

        mysql> select concat('+', trim(' aaa '), '+');
        +---------------------------------+
        | concat('+', trim(' aaa '), '+') |
        +---------------------------------+
        | +aaa+                           |
        +---------------------------------+
        1 row in set (0.00 sec)

8. 删除指定字符串的函数

        // 头尾去掉指定字符串
        mysql> select trim('ab' from 'abababa11111bab');
        +-----------------------------------+
        | trim('ab' from 'abababa11111bab') |
        +-----------------------------------+
        | a11111b                           |
        +-----------------------------------+
        1 row in set (0.00 sec)

9. 重复生成字符串函数

        // 生成重复字符串指定次数
        mysql> select repeat('12345', 3);
        +--------------------+
        | repeat('12345', 3) |
        +--------------------+
        | 123451234512345    |
        +--------------------+
        1 row in set (0.00 sec)

10. 空格函数和替换函数

        // 产生指定个数空格的串
        mysql> select concat('+', space(3), '+');
        +----------------------------+
        | concat('+', space(3), '+') |
        +----------------------------+
        | +   +                      |
        +----------------------------+
        1 row in set (0.00 sec)

        // 替换指定字符串为新字符串
        mysql> select replace('1234567890-1234567890', '345', 'aa');
        +-----------------------------------------------+
        | replace('1234567890-1234567890', '345', 'aa') |
        +-----------------------------------------------+
        | 12aa67890-12aa67890                           |
        +-----------------------------------------------+
        1 row in set (0.00 sec)

11. 比较字符串大小函数

        mysql> select strcmp('abc', 'acd'), strcmp('abc', 'abc'), strcmp('abc', 'aad'), strcmp('abc', 'ab');
        +----------------------+----------------------+----------------------+---------------------+
        | strcmp('abc', 'acd') | strcmp('abc', 'abc') | strcmp('abc', 'aad') | strcmp('abc', 'ab') |
        +----------------------+----------------------+----------------------+---------------------+
        |                   -1 |                    0 |                    1 |                   1 |
        +----------------------+----------------------+----------------------+---------------------+
        1 row in set (0.00 sec)

12. 获取子串函数

        // substring 和 mid 功能一样
        mysql> select substring('1234567890', 4, 3), mid('1234567890', 4, 3);
        +-------------------------------+-------------------------+
        | substring('1234567890', 4, 3) | mid('1234567890', 4, 3) |
        +-------------------------------+-------------------------+
        | 456                           | 456                     |
        +-------------------------------+-------------------------+
        1 row in set (0.00 sec)

        mysql> select substring('1234567890', 4, 30), mid('1234567890', 4, 30);
        +--------------------------------+--------------------------+
        | substring('1234567890', 4, 30) | mid('1234567890', 4, 30) |
        +--------------------------------+--------------------------+
        | 4567890                        | 4567890                  |
        +--------------------------------+--------------------------+
        1 row in set (0.00 sec)

13. 匹配子串开始位置函数

        // 三个函数作用相同
        mysql> select locate('456', '1234567890'), position('456' in '1234567890'), instr('1234567890', '456');
        +-----------------------------+---------------------------------+----------------------------+
        | locate('456', '1234567890') | position('456' in '1234567890') | instr('1234567890', '456') |
        +-----------------------------+---------------------------------+----------------------------+
        |                           4 |                               4 |                          4 |
        +-----------------------------+---------------------------------+----------------------------+
        1 row in set (0.00 sec)

        mysql> select locate('456a', '1234567890'), position('456a' in '1234567890'), instr('1234567890', '456a');
        +------------------------------+----------------------------------+-----------------------------+
        | locate('456a', '1234567890') | position('456a' in '1234567890') | instr('1234567890', '456a') |
        +------------------------------+----------------------------------+-----------------------------+
        |                            0 |                                0 |                           0 |
        +------------------------------+----------------------------------+-----------------------------+
        1 row in set (0.00 sec)

14. 字符串逆序函数

        mysql> select reverse('1234567890');
        +-----------------------+
        | reverse('1234567890') |
        +-----------------------+
        | 0987654321            |
        +-----------------------+
        1 row in set (0.00 sec)

15. 返回指定位置的字符串函数

        // 返回给定多个字符串中的指定索引(从1开始)位置的字符串
        mysql> select elt(2, 'aaa', 'bbb', 'ccc', 'ddd');
        +------------------------------------+
        | elt(2, 'aaa', 'bbb', 'ccc', 'ddd') |
        +------------------------------------+
        | bbb                                |
        +------------------------------------+
        1 row in set (0.00 sec)

        mysql> select elt(4, 'aaa', 'bbb', 'ccc', 'ddd');
        +------------------------------------+
        | elt(4, 'aaa', 'bbb', 'ccc', 'ddd') |
        +------------------------------------+
        | ddd                                |
        +------------------------------------+
        1 row in set (0.00 sec)

        mysql> select elt(0, 'aaa', 'bbb', 'ccc', 'ddd');
        +------------------------------------+
        | elt(0, 'aaa', 'bbb', 'ccc', 'ddd') |
        +------------------------------------+
        | NULL                               |
        +------------------------------------+
        1 row in set (0.00 sec)

        mysql> select elt(5, 'aaa', 'bbb', 'ccc', 'ddd');
        +------------------------------------+
        | elt(5, 'aaa', 'bbb', 'ccc', 'ddd') |
        +------------------------------------+
        | NULL                               |
        +------------------------------------+
        1 row in set (0.00 sec)

16. 返回指定字符串位置的函数

        // 返回第一个字符串在后续字符串列表中出现的索引位置(从1开始)
        mysql> select field('bb', 'aa', 'bb', 'cc', 'dd');
        +-------------------------------------+
        | field('bb', 'aa', 'bb', 'cc', 'dd') |
        +-------------------------------------+
        |                                   2 |
        +-------------------------------------+
        1 row in set (0.00 sec)

        mysql> select field('xx', 'aa', 'bb', 'cc', 'dd');
        +-------------------------------------+
        | field('xx', 'aa', 'bb', 'cc', 'dd') |
        +-------------------------------------+
        |                                   0 |
        +-------------------------------------+
        1 row in set (0.00 sec)

        mysql> select field('dd', 'aa', 'bb', 'cc', 'dd');
        +-------------------------------------+
        | field('dd', 'aa', 'bb', 'cc', 'dd') |
        +-------------------------------------+
        |                                   4 |
        +-------------------------------------+
        1 row in set (0.00 sec)

17. 返回子串位置的函数

        // 返回第一个字符串在第二个字符串中出现的索引位置(从1开始)
        // 第二个字符串是用逗号分隔的字符串集合
        mysql> select find_in_set('like', 'i,like,apple');
        +-------------------------------------+
        | find_in_set('like', 'i,like,apple') |
        +-------------------------------------+
        |                                   2 |
        +-------------------------------------+
        1 row in set (0.00 sec)

18. 选取字符串的函数

        mysql> select bin(12);
        +---------+
        | bin(12) |
        +---------+
        | 1100    |
        +---------+
        1 row in set (0.00 sec)

        // 返回第一个数的二进制表示中1对应的字符串连接起来
        // 二进制数从右往左数
        // 字符串集合从左往右数
        mysql> select make_set(12, 'aa', 'bb', 'cc', 'dd', 'ee');
        +--------------------------------------------+
        | make_set(12, 'aa', 'bb', 'cc', 'dd', 'ee') |
        +--------------------------------------------+
        | cc,dd                                      |
        +--------------------------------------------+
        1 row in set (0.00 sec)

        mysql> select bin(13);
        +---------+
        | bin(13) |
        +---------+
        | 1101    |
        +---------+
        1 row in set (0.00 sec)

        mysql> select make_set(13, 'aa', 'bb', 'cc', 'dd', 'ee');
        +--------------------------------------------+
        | make_set(13, 'aa', 'bb', 'cc', 'dd', 'ee') |
        +--------------------------------------------+
        | aa,cc,dd                                   |
        +--------------------------------------------+
        1 row in set (0.00 sec)

# 日期和时间函数

1. 获取当前日期的函数和获取当前时间的函数

        mysql> select curdate(), current_date(), curtime(), current_time();
        +------------+----------------+-----------+----------------+
        | curdate()  | current_date() | curtime() | current_time() |
        +------------+----------------+-----------+----------------+
        | 2017-11-23 | 2017-11-23     | 19:34:45  | 19:34:45       |
        +------------+----------------+-----------+----------------+
        1 row in set (0.00 sec)

2. 获取当前日期和时间的函数

        // 都一样，一般用now()
        mysql> select now(), current_timestamp(), localtime(), sysdate(), localtimestamp();
        +---------------------+---------------------+---------------------+---------------------+---------------------+
        | now()               | current_timestamp() | localtime()         | sysdate()           | localtimestamp()    |
        +---------------------+---------------------+---------------------+---------------------+---------------------+
        | 2017-11-23 19:37:04 | 2017-11-23 19:37:04 | 2017-11-23 19:37:04 | 2017-11-23 19:37:04 | 2017-11-23 19:37:04 |
        +---------------------+---------------------+---------------------+---------------------+---------------------+
        1 row in set (0.00 sec)

3. UNIX时间戳函数

        // unix_timestamp() 返回unix时间戳
        // unix_timestamp(now()) 普通时间转unix时间戳
        // from_unixtime('1511437231') unix时间戳转普通时间
        mysql> select now(), unix_timestamp(), unix_timestamp(now());
        +---------------------+------------------+-----------------------+
        | now()               | unix_timestamp() | unix_timestamp(now()) |
        +---------------------+------------------+-----------------------+
        | 2017-11-23 19:40:31 |       1511437231 |            1511437231 |
        +---------------------+------------------+-----------------------+
        1 row in set (0.00 sec)

        mysql> select from_unixtime(unix_timestamp());
        +---------------------------------+
        | from_unixtime(unix_timestamp()) |
        +---------------------------------+
        | 2017-11-23 19:41:38             |
        +---------------------------------+
        1 row in set (0.00 sec)

        mysql> select from_unixtime('1511437231');
        +-----------------------------+
        | from_unixtime('1511437231') |
        +-----------------------------+
        | 2017-11-23 19:40:31.000000  |
        +-----------------------------+
        1 row in set (0.00 sec)

        mysql> select unix_timestamp('2017-11-23 19:40:31');
        +---------------------------------------+
        | unix_timestamp('2017-11-23 19:40:31') |
        +---------------------------------------+
        |                            1511437231 |
        +---------------------------------------+

4. 返回utc日期的函数和返回utc时间的函数

        mysql> select curdate(), utc_date(), curtime(), utc_time();
        +------------+------------+-----------+------------+
        | curdate()  | utc_date() | curtime() | utc_time() |
        +------------+------------+-----------+------------+
        | 2017-11-23 | 2017-11-23 | 19:47:48  | 11:47:48   |
        +------------+------------+-----------+------------+
        1 row in set (0.00 sec)

5. 获取月份函数

        // month() 获取月份(1-12)
        mysql> select month('2017-11-23 19:40:31'), month('2017-11-23'), month(now()), monthname(now());
        +------------------------------+---------------------+--------------+------------------+
        | month('2017-11-23 19:40:31') | month('2017-11-23') | month(now()) | monthname(now()) |
        +------------------------------+---------------------+--------------+------------------+
        |                           11 |                  11 |           11 | November         |
        +------------------------------+---------------------+--------------+------------------+
        1 row in set (0.00 sec)

6. 获取星期函数

        // dayname(now()) 返回星期英文名
        // dayofweek(now()) 返回星期序号，1-7 => 周日-周六
        // weekday(now())  返回星期序号，0-6 => 周一-周日
        mysql> select dayname(now()), dayofweek(now()), weekday(now());
        +----------------+------------------+----------------+
        | dayname(now()) | dayofweek(now()) | weekday(now()) |
        +----------------+------------------+----------------+
        | Thursday       |                5 |              3 |
        +----------------+------------------+----------------+
        1 row in set (0.00 sec)

7. 获取星期数的函数

        // 返回本年第几个星期，1-53
        mysql> select week(now()), weekofyear(now());
        +-------------+-------------------+
        | week(now()) | weekofyear(now()) |
        +-------------+-------------------+
        |          47 |                47 |
        +-------------+-------------------+
        1 row in set (0.00 sec)

8. 获取天数的函数

        // dayofyear(now()) 一年中的第几天
        // dayofmonth(now()) 一月中的第几天
        mysql> select dayofyear(now()), dayofmonth(now());
        +------------------+-------------------+
        | dayofyear(now()) | dayofmonth(now()) |
        +------------------+-------------------+
        |              327 |                23 |
        +------------------+-------------------+
        1 row in set (0.00 sec)

9. 获取年份、季度、小时、分钟、秒的函数

        mysql> select year(now()), quarter(now()), hour(now()), minute(now()), second(now());
        +-------------+----------------+-------------+---------------+---------------+
        | year(now()) | quarter(now()) | hour(now()) | minute(now()) | second(now()) |
        +-------------+----------------+-------------+---------------+---------------+
        |        2017 |              4 |          20 |             0 |            55 |
        +-------------+----------------+-------------+---------------+---------------+
        1 row in set (0.00 sec)

10. 获取日期指定值的函数

        mysql> select extract(year from now());
        +--------------------------+
        | extract(year from now()) |
        +--------------------------+
        |                     2017 |
        +--------------------------+
        1 row in set (0.00 sec)

        mysql> select extract(month from now());
        +---------------------------+
        | extract(month from now()) |
        +---------------------------+
        |                        11 |
        +---------------------------+
        1 row in set (0.00 sec)

        mysql> select extract(day from now());
        +-------------------------+
        | extract(day from now()) |
        +-------------------------+
        |                      23 |
        +-------------------------+
        1 row in set (0.00 sec)

        mysql> select extract(hour from now());
        +--------------------------+
        | extract(hour from now()) |
        +--------------------------+
        |                       20 |
        +--------------------------+
        1 row in set (0.00 sec)

        mysql> select extract(minute from now());
        +----------------------------+
        | extract(minute from now()) |
        +----------------------------+
        |                          3 |
        +----------------------------+
        1 row in set (0.00 sec)

        mysql> select extract(second from now());
        +----------------------------+
        | extract(second from now()) |
        +----------------------------+
        |                         34 |
        +----------------------------+
        1 row in set (0.00 sec)

11. 时间和秒转换函数

        mysql> select time_to_sec(current_time());
        +-----------------------------+
        | time_to_sec(current_time()) |
        +-----------------------------+
        |                       72342 |
        +-----------------------------+
        1 row in set (0.00 sec)

        mysql> select sec_to_time(72342);
        +--------------------+
        | sec_to_time(72342) |
        +--------------------+
        | 20:05:42           |
        +--------------------+
        1 row in set (0.00 sec)

12. 计算日期和时间的函数

        // 计算日期从0000年1月1日的天数
        mysql> select to_days(now());
        +----------------+
        | to_days(now()) |
        +----------------+
        |         737021 |
        +----------------+
        1 row in set (0.00 sec)

        // 计算从0000年1月1日开始n天后日期
        mysql> select from_days(737021);
        +-------------------+
        | from_days(737021) |
        +-------------------+
        | 2017-11-23        |
        +-------------------+
        1 row in set (0.00 sec)

        // 计算d1和d2间隔的天数
        mysql> select datediff('2017-11-23', '2017-11-01');
        +--------------------------------------+
        | datediff('2017-11-23', '2017-11-01') |
        +--------------------------------------+
        |                                   22 |
        +--------------------------------------+
        1 row in set (0.00 sec)

        // 增加天数
        mysql> select adddate('2017-11-23 20:14:06', 3);
        +-----------------------------------+
        | adddate('2017-11-23 20:14:06', 3) |
        +-----------------------------------+
        | 2017-11-26 20:14:06               |
        +-----------------------------------+
        1 row in set (0.00 sec)

        // 减少天数
        mysql> select subdate('2017-11-23 20:14:06', 3);
        +-----------------------------------+
        | subdate('2017-11-23 20:14:06', 3) |
        +-----------------------------------+
        | 2017-11-20 20:14:06               |
        +-----------------------------------+
        1 row in set (0.00 sec)

        // 增加秒
        mysql> select addtime('2017-11-23 20:14:06', 3);
        +-----------------------------------+
        | addtime('2017-11-23 20:14:06', 3) |
        +-----------------------------------+
        | 2017-11-23 20:14:09               |
        +-----------------------------------+
        1 row in set (0.00 sec)

        // 减少秒
        mysql> select subtime('2017-11-23 20:14:06', 3);
        +-----------------------------------+
        | subtime('2017-11-23 20:14:06', 3) |
        +-----------------------------------+
        | 2017-11-23 20:14:03               |
        +-----------------------------------+
        1 row in set (0.00 sec)

        //  adddate/date_add/subdate(d, INTERVAL expr type) 三个函数参数一样：
        类型                      含义              expr表达式形式
        -------------------------------------------------------------
        year                    年               YY
        month                   月               MM
        day                     日               DD
        hour                    时               hh
        minute                  分               mm
        second                  秒               ss
        year_month              年和月            YY MM 中间任意符号分隔 
        day_hour                日和时            DD hh 中间任意符号分隔
        day_minute              日和分            DD mm 中间任意符号分隔
        day_second              日和秒            DD ss 中间任意符号分隔
        hour_minute             时和分            hh mm 中间任意符号分隔
        hour_second             时和秒            hh ss 中间任意符号分隔
        minute_second           分和秒            mm ss 中间任意符号分隔
        -------------------------------------------------------------

        // 添加日期
        mysql> select adddate('2017-11-23 20:14:06', interval '1 1' year_month);
        +-----------------------------------------------------------+
        | adddate('2017-11-23 20:14:06', interval '1 1' year_month) |
        +-----------------------------------------------------------+
        | 2018-12-23 20:14:06                                       |
        +-----------------------------------------------------------+
        1 row in set (0.00 sec)

        // 添加日期，同上
        mysql> select date_add('2017-11-23 20:14:06', interval '1 1' year_month);
        +------------------------------------------------------------+
        | date_add('2017-11-23 20:14:06', interval '1 1' year_month) |
        +------------------------------------------------------------+
        | 2018-12-23 20:14:06                                        |
        +------------------------------------------------------------+
        1 row in set (0.00 sec)

        // 减少日期
        mysql> select subdate('2017-11-23 20:14:06', interval '1 1' year_month);
        +-----------------------------------------------------------+
        | subdate('2017-11-23 20:14:06', interval '1 1' year_month) |
        +-----------------------------------------------------------+
        | 2016-10-23 20:14:06                                       |
        +-----------------------------------------------------------+
        1 row in set (0.00 sec)


13. 日期和时间格式化函数

        // 日期格式
        mysql> select now(), date_format(now(), '%Y-%m-%d %H:%i:%s');
        +---------------------+-----------------------------------------+
        | now()               | date_format(now(), '%Y-%m-%d %H:%i:%s') |
        +---------------------+-----------------------------------------+
        | 2017-11-23 20:38:24 | 2017-11-23 20:38:24                     |
        +---------------------+-----------------------------------------+
        1 row in set (0.00 sec)

        // 日期格式
        mysql> select now(), date_format(now(), '%Y%m%d%H%i%s');
        +---------------------+------------------------------------+
        | now()               | date_format(now(), '%Y%m%d%H%i%s') |
        +---------------------+------------------------------------+
        | 2017-11-23 20:38:57 | 20171123203857                     |
        +---------------------+------------------------------------+
        1 row in set (0.00 sec)

        // 时间格式
        mysql> select now(), time_format(now(), '%H%i%s');
        +---------------------+------------------------------+
        | now()               | time_format(now(), '%H%i%s') |
        +---------------------+------------------------------+
        | 2017-11-23 20:39:53 | 203953                       |
        +---------------------+------------------------------+
        1 row in set (0.00 sec)

        // 获取格式串
        mysql> select get_format(datetime, 'iso');
        +-----------------------------+
        | get_format(datetime, 'iso') |
        +-----------------------------+
        | %Y-%m-%d %H:%i:%s           |
        +-----------------------------+
        1 row in set (0.00 sec)

        // 使用格式串
        mysql> select date_format(now(), get_format(datetime, 'iso'));
        +-------------------------------------------------+
        | date_format(now(), get_format(datetime, 'iso')) |
        +-------------------------------------------------+
        | 2017-11-23 20:42:49                             |
        +-------------------------------------------------+
        1 row in set (0.00 sec)

# 条件判断函数

1. if(expr, v1, v2)函数

    如果expr成立返回v1，否则返回v2。

        mysql> select if(2 > 1, '大于', '小于');
        +-------------------------------+
        | if(2 > 1, '大于', '小于')      |
        +-------------------------------+
        | 大于                          |
        +-------------------------------+
        1 row in set (0.00 sec)

        mysql> select if(2 < 1, '大于', '小于');
        +-------------------------------+
        | if(2 < 1, '大于', '小于')      |
        +-------------------------------+
        | 小于                          |
        +-------------------------------+
        1 row in set (0.00 sec)

2. ifnull(v1, v2)函数

    如果v1不为空返回v1，否则返回v2。

        mysql> select ifnull(0, '小于');
        +---------------------+
        | ifnull(0, '小于')   |
        +---------------------+
        | 0                   |
        +---------------------+
        1 row in set (0.00 sec)

        mysql> select ifnull(1, '小于');
        +---------------------+
        | ifnull(1, '小于')   |
        +---------------------+
        | 1                   |
        +---------------------+
        1 row in set (0.00 sec)

        mysql> select ifnull(2, '小于');
        +---------------------+
        | ifnull(2, '小于')   |
        +---------------------+
        | 2                   |
        +---------------------+
        1 row in set (0.00 sec)

        mysql> select ifnull(NULL, '小于');
        +------------------------+
        | ifnull(NULL, '小于')   |
        +------------------------+
        | 小于                   |
        +------------------------+
        1 row in set (0.00 sec)

        mysql> select ifnull(null, '小于');
        +------------------------+
        | ifnull(null, '小于')   |
        +------------------------+
        | 小于                   |
        +------------------------+
        1 row in set (0.00 sec)

3. case函数

* 形式一

        case 
        when expr1 then v1
        [when expr2 then v2]
        [...]
        [else vn]
        end

        mysql> select
            -> 85 as 成绩,
            -> case
            -> when 85 > 90 then '优秀'
            -> when 85 > 80 then '优良'
            -> when 85 > 60 then '及格'
            -> else '不及格'
            -> end as 成绩水平;
        +--------+--------------+
        | 成绩   | 成绩水平       |
        +--------+--------------+
        |     85 | 优良         |
        +--------+--------------+
        1 row in set (0.00 sec)

* 形式二

        case expr
        when e1 then v1
        [when e2 then v2]
        [...]
        [else vn]
        end

        mysql> select
            -> 85 as 成绩,
            -> case 85
            -> when 90 then '优秀'
            -> when 85 then '优良'
            -> when 60 then '及格'
            -> else '不及格'
            -> end as 成绩水平;
        +--------+--------------+
        | 成绩   | 成绩水平     |
        +--------+--------------+
        |     85 | 优良         |
        +--------+--------------+
        1 row in set (0.00 sec)



# 系统信息函数

1. 获取MySQL版本号、连接数和数据库名的函数

        // version() 数据库版本号 
        // connection_id() 服务器连接数
        // database() 当前数据库名
        // schema() 当前数据库名
        mysql> select version(), connection_id(), database(), schema();
        +------------+-----------------+------------+----------+
        | version()  | connection_id() | database() | schema() |
        +------------+-----------------+------------+----------+
        | 5.7.20-log |               4 | tempdb     | tempdb   |
        +------------+-----------------+------------+----------+
        1 row in set (0.00 sec)

2. 获取用户名的函数

        // 这几个函数都返回当前用户信息
        mysql> select user(), system_user(), session_user(), current_user(), current_user;
        +----------------+----------------+----------------+----------------+----------------+
        | user()         | system_user()  | session_user() | current_user() | current_user   |
        +----------------+----------------+----------------+----------------+----------------+
        | root@localhost | root@localhost | root@localhost | root@localhost | root@localhost |
        +----------------+----------------+----------------+----------------+----------------+
        1 row in set (0.00 sec)

        // 连接远程主机数据库服务器
        [root@centos-server ~]# mysql -h test.kuaikuaikeji.com -P 33061 -uadmin -pxxxxxxxx
        
        mysql> select user(), system_user(), session_user(), current_user(), current_user;
        +----------------------+----------------------+----------------------+----------------+--------------+
        | user()               | system_user()        | session_user()       | current_user() | current_user |
        +----------------------+----------------------+----------------------+----------------+--------------+
        | admin@192.168.40.220 | admin@192.168.40.220 | admin@192.168.40.220 | admin@%        | admin@%      |
        +----------------------+----------------------+----------------------+----------------+--------------+
        1 row in set (0.00 sec)


3. 获取字符串的字符集和排序方式的函数

        mysql> select charset('aa'), collation('aa');
        +---------------+-----------------+
        | charset('aa') | collation('aa') |
        +---------------+-----------------+
        | utf8          | utf8_general_ci |
        +---------------+-----------------+
        1 row in set (0.02 sec)

4. 获取最后一个自动生成的id值的函数

        mysql> INSERT INTO user (id, num, name, age, height, memo, create_time) VALUES (NULL, '100', 'xxx', '30', '180', NULL, '2017-11-23 10:40:40');
        Query OK, 1 row affected (0.00 sec)

        mysql> select * from user;
        +----+-----+--------+-----+--------+------+---------------------+
        | id | num | name   | age | height | memo | create_time         |
        +----+-----+--------+-----+--------+------+---------------------+
        |  3 | 003 | 王五   |  30 |    180 | NULL | 2017-11-23 10:35:39 |
        |  4 | 004 | 赵六   |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        |  5 | 005 | 马七   |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        |  6 | 006 | 羊八   |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        |  7 | 007 | xxx    |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        |  8 | 008 | xxx    |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        |  9 | 009 | xxx    |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        | 10 | 100 | xxx    |  30 |    180 | NULL | 2017-11-23 10:40:40 |
        +----+-----+--------+-----+--------+------+---------------------+
        8 rows in set (0.00 sec)

        // 获取当前连接最近一次insert操作自动生成的id值
        mysql> select last_insert_id();
        +------------------+
        | last_insert_id() |
        +------------------+
        |               10 |
        +------------------+
        1 row in set (0.00 sec)

# 加密函数

1. 加密函数password(str)

    主要用来给用户密码加密。

        mysql> select User, authentication_string from  mysql.user;
        +---------------+-------------------------------------------+
        | User          | authentication_string                     |
        +---------------+-------------------------------------------+
        | root          | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 |
        | mysql.session | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |
        | mysql.sys     | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |
        | root          | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 |
        +---------------+-------------------------------------------+
        4 rows in set (0.00 sec)

        mysql> select password('123456');
        +-------------------------------------------+
        | password('123456')                        |
        +-------------------------------------------+
        | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 |
        +-------------------------------------------+
        1 row in set, 1 warning (0.00 sec)

2. 加密函数md5(str)

        mysql> select md5('123456');
        +----------------------------------+
        | md5('123456')                    |
        +----------------------------------+
        | e10adc3949ba59abbe56e057f20f883e |
        +----------------------------------+
        1 row in set (0.00 sec)

3. 加密函数encode(str, pswd_str)

        // encode(str, pswd_str) 返回加密后的二进制字节流
        mysql> select encode('abcd', 'aa');
        +----------------------+
        | encode('abcd', 'aa') |
        +----------------------+
        | �                  |
        +----------------------+
        1 row in set, 1 warning (0.00 sec)

4. 解密函数decode(crypt_str, pswd_str)

        mysql> select decode(encode('abcd', 'aa'), 'aa');
        +------------------------------------+
        | decode(encode('abcd', 'aa'), 'aa') |
        +------------------------------------+
        | abcd                               |
        +------------------------------------+
        1 row in set, 2 warnings (0.00 sec)

# 其他函数

1. 格式化函数format(x, n)

    将x四舍五入保留n位小数。

        mysql> select format(3.14159, 3);
        +--------------------+
        | format(3.14159, 3) |
        +--------------------+
        | 3.142              |
        +--------------------+
        1 row in set (0.00 sec)

2. 不同进制转换函数

        // 取第一个字符的ascii值
        mysql> select ascii('ABC');
        +--------------+
        | ascii('ABC') |
        +--------------+
        |           65 |
        +--------------+
        1 row in set (0.00 sec)

        // 取十进制数的二进制表示
        mysql> select bin(17);
        +---------+
        | bin(17) |
        +---------+
        | 10001   |
        +---------+
        1 row in set (0.00 sec)

        // 取十进制数的八进制表示
        mysql> select oct(17);
        +---------+
        | oct(17) |
        +---------+
        | 21      |
        +---------+
        1 row in set (0.00 sec)

        // // 取十进制数的十六进制表示
        mysql> select hex(17);
        +---------+
        | hex(17) |
        +---------+
        | 11      |
        +---------+
        1 row in set (0.00 sec)

        // conv(x, f1, f2)
        // 将f1进制表示的x转为f2进制表示
        mysql> select conv(11, 16, 10);
        +------------------+
        | conv(11, 16, 10) |
        +------------------+
        | 17               |
        +------------------+
        1 row in set (0.00 sec)

        mysql> select conv(11, 16, 2);
        +-----------------+
        | conv(11, 16, 2) |
        +-----------------+
        | 10001           |
        +-----------------+
        1 row in set (0.00 sec)

        mysql> select conv(11, 16, 8);
        +-----------------+
        | conv(11, 16, 8) |
        +-----------------+
        | 21              |
        +-----------------+
        1 row in set (0.00 sec)

        mysql> select conv(11, 10, 2);
        +-----------------+
        | conv(11, 10, 2) |
        +-----------------+
        | 1011            |
        +-----------------+
        1 row in set (0.00 sec)

3. ip地址和数字转换函数

        mysql> select inet_aton('192.168.1.20');
        +---------------------------+
        | inet_aton('192.168.1.20') |
        +---------------------------+
        |                3232235796 |
        +---------------------------+
        1 row in set (0.00 sec)

        mysql> select inet_ntoa(3232235796);
        +-----------------------+
        | inet_ntoa(3232235796) |
        +-----------------------+
        | 192.168.1.20          |
        +-----------------------+
        1 row in set (0.00 sec)

4. 加锁函数和解锁函数

        // 定义一个名为aaa的锁，持续时间60秒
        // 成功返回1
        // 超时返回0
        // 错误返回NULL
        mysql> select get_lock('aaa', 60);
        +---------------------+
        | get_lock('aaa', 60) |
        +---------------------+
        |                   1 |
        +---------------------+
        1 row in set (0.00 sec)

        // 是否使用名为aaa的锁
        // 使用返回0
        // 否则返回1
        mysql> select is_free_lock('aaa');
        +---------------------+
        | is_free_lock('aaa') |
        +---------------------+
        |                   0 |
        +---------------------+
        1 row in set (0.00 sec)

        // 解除名为aaa的锁
        // 成功返回1
        // 超时返回0
        // 错误返回NULL
        mysql> select release_lock('aaa');
        +---------------------+
        | release_lock('aaa') |
        +---------------------+
        |                   1 |
        +---------------------+
        1 row in set (0.00 sec)

        mysql> select is_free_lock('aaa');
        +---------------------+
        | is_free_lock('aaa') |
        +---------------------+
        |                   1 |
        +---------------------+
        1 row in set (0.00 sec)

5. 重复执行指定操作的函数

        // benchmark(count, expr)
        // 重复执行expr表达式count次，返回执行时间
        mysql> select benchmark(1000 * 100, concat('aaaaa', 'bbbb'));
        +------------------------------------------------+
        | benchmark(1000 * 100, concat('aaaaa', 'bbbb')) |
        +------------------------------------------------+
        |                                              0 |
        +------------------------------------------------+
        1 row in set (0.00 sec)

6. 改变字符集的函数

        mysql> select charset('aaa'), charset(convert('aaa' using gbk));
        +----------------+-----------------------------------+
        | charset('aaa') | charset(convert('aaa' using gbk)) |
        +----------------+-----------------------------------+
        | utf8           | gbk                               |
        +----------------+-----------------------------------+
        1 row in set (0.00 sec)

        mysql> select charset('aaa');
        +----------------+
        | charset('aaa') |
        +----------------+
        | utf8           |
        +----------------+
        1 row in set (0.00 sec)

        mysql> select convert('aaa' using gbk);
        +--------------------------+
        | convert('aaa' using gbk) |
        +--------------------------+
        | aaa                      |
        +--------------------------+
        1 row in set (0.00 sec)

7. 改变字段数据类型的函数

        // cast(x as type)
        // convert(x, type)
        // 将x转变成type类型
        // 只对binary, char, date, datetime, time, signed integer, unsigned integer.
        mysql> select cast('2017-01-01' as datetime);
        +--------------------------------+
        | cast('2017-01-01' as datetime) |
        +--------------------------------+
        | 2017-01-01 00:00:00            |
        +--------------------------------+
        1 row in set (0.00 sec)

        mysql> select convert('2017-01-01', datetime);
        +---------------------------------+
        | convert('2017-01-01', datetime) |
        +---------------------------------+
        | 2017-01-01 00:00:00             |
        +---------------------------------+
        1 row in set (0.00 sec)

        mysql> select cast('123' as signed int);
        +---------------------------+
        | cast('123' as signed int) |
        +---------------------------+
        |                       123 |
        +---------------------------+
        1 row in set (0.00 sec)

        mysql> select cast('123' as unsigned int);
        +-----------------------------+
        | cast('123' as unsigned int) |
        +-----------------------------+
        |                         123 |
        +-----------------------------+
        1 row in set (0.00 sec)

        mysql> select cast('123' as unsigned int) + 100;
        +-----------------------------------+
        | cast('123' as unsigned int) + 100 |
        +-----------------------------------+
        |                               223 |
        +-----------------------------------+
        1 row in set (0.00 sec)

        mysql> select '123' + 100;
        +-------------+
        | '123' + 100 |
        +-------------+
        |         223 |
        +-------------+
        1 row in set (0.00 sec)

# 完。